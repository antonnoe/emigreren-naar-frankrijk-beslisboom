<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Migreren naar Frankrijk – Scenario Check</title>
<meta name="description" content="Interactieve emigratie-scenariocheck voor een succesvolle verhuizing naar Frankrijk. Keuzevragen, impactanalyse, en routing naar betrouwbare NL/FR bronnen en tools.">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://antonnoe.github.io/emigreren-naar-frankrijk-beslisboom/">
<style>
 body { font-family: Arial, sans-serif; background:#fff; color:#000; margin:0; padding:20px; }
 .question { margin-bottom:18px; padding:14px; border:1px solid #ddd; border-radius:12px; }
 button { padding:10px 16px; margin-top:6px; border:1px solid #000; background:#fff; border-radius:8px; cursor:pointer; }
 select, input { width:100%; padding:10px; border:1px solid #000; border-radius:8px; }
 #results { margin-top:30px; padding:18px; border:2px solid #000; border-radius:12px; }
</style>
</head>
<body>

<h1>Migreren naar Frankrijk – Scenario Check</h1>
<p>Maak keuzes. Geen herhaling. Instant impact. Bewerk via 'Terug'. PDF-export met bruikbare links.</p>

<div id="wizard"></div>

<div id="results" style="display:none;">
  <h2>Uw scenario-uitkomst</h2>
  <div id="output"></div>
  <button onclick="goBack()">Terug</button>
  <button onclick="exportPDF()">PDF emigratiedossier printen</button>
</div>

<script type="module">
import { calculateOutcome } from "./script.js";
import { exportToPDF } from "./pdf.js";

// Laad configuratie
const config = await fetch("./tree-config.json").then(r => r.json());

// Render vragen
function render(q, i, saved) {
  if (q.type==="choice") return `
    <select id="q${i}">
      ${q.opties.map(o=>`<option ${saved===o?"selected":""} value="${o}">${o}</option>`).join("")}
    </select>`;
  if (q.type==="boolean") return `
    <select id="q${i}">
      <option value="">Kies…</option>
      <option ${saved===true?"selected":""} value="ja">Ja</option>
      <option ${saved===false?"selected":""} value="nee">Nee</option>
      ${q.allowNA?`<option ${saved==="n.v.t."?"selected":""} value="n.v.t.">Niet van toepassing</option>`:""}
    </select>`;
  return `<input id="q${i}" value="${saved||''}" type="text" placeholder="${q.placeholder||''}" />`;
}

function renderWizard() {
  const box = localStorage.getItem("migrationState");
  const state = box ? JSON.parse(box) : {};
  wizard.innerHTML = config.map((q,i)=>`
    <div class="question"><label><strong>${q.vraag}</strong></label>${render(q,i,state[`q${i}`])}</div>
  `).join("") + `<button onclick="submitWizard()">Scenario check</button>`;
}

window.submitWizard = () => {
  const state = {};
  config.forEach((q,i)=>{
    const v = document.getElementById(`q${i}`).value;
    if (v==="ja") state[`q${i}`] = true;
    else if (v==="nee") state[`q${i}`] = false;
    else if (v==="n.v.t.") state[`q${i}`] = "n.v.t.";
    else state[`q${i}`] = v || "";
  });
  localStorage.setItem("migrationState", JSON.stringify(state));
  const o = calculateOutcome(state);
  results.style.display="block";
  output.textContent = JSON.stringify(o, null, 2);
};

window.goBack = () => { results.style.display="none"; renderWizard(); };
window.exportPDF = () => exportToPDF(JSON.parse(localStorage.getItem("migrationState")));
window.exportPDF = () => exportToPDF(JSON.parse(localStorage.getItem("migrationState")));

renderWizard();
</script>
</body>
</html>
